(window.webpackJsonp=window.webpackJsonp||[]).push([[221],{575:function(t,e,n){"use strict";n.r(e);var a=n(42),s=Object(a.a)({},(function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h1",{attrs:{id:"mwait"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#mwait"}},[t._v("#")]),t._v(" MWAIT")]),t._v(" "),n("h2",{attrs:{id:"monitor-wait"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#monitor-wait"}},[t._v("#")]),t._v(" Monitor Wait")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[t._v("Opcode")]),t._v(" "),n("th",[t._v("Mnemonic")]),t._v(" "),n("th",[t._v("Description")])])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("0F 01 C9")]),t._v(" "),n("td",[t._v("MWAIT")]),t._v(" "),n("td",[t._v("A hint that allows the processor to stop instruction execution and enter an implementation-dependent optimized state until occurrence of a class of events; it is architecturally identical to a NOP instruction.")])])])]),t._v(" "),n("h2",{attrs:{id:"description"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#description"}},[t._v("#")]),t._v(" Description")]),t._v(" "),n("p",[t._v("The MWAIT instruction is designed to operate with the MONITOR instruction. The two instructions allow the definition of an address at which to 'wait' (MONITOR) and an instruction that causes a predefined 'implementation-dependent-optimized operation' to commence at the 'wait' address (MWAIT). The execution of MWAIT is a hint to the processor that it can enter an implementation-dependent-optimized state while waiting for an event or a store operation to the address range armed by the preceding MONITOR instruction in program flow.")]),t._v(" "),n("p",[t._v("EAX and ECX is used to communicate other information to the MWAIT instruction, such as the kind of optimized state the processor should enter. ECX specifies optional extensions for the MWAIT instruction. EAX may contain hints such as the preferred optimized state the processor should enter. For Pentium 4 processors with CPUID signature family = 15 and model = 3, all non-zero values for EAX and ECX are reserved. The processor will raise a general protection fault on the execution of MWAIT with reserved values in ECX, whereas it ignores the setting of reserved bits in EAX.")]),t._v(" "),n("p",[t._v("A store to the address range armed by the MONITOR instruction, an interrupt, an NMI or SMI, a debug exception, a machine check exception, the BINIT# signal, the INIT# signal, or the RESET# signal will exit the implementation-dependent-optimized state. Note that an interrupt will cause the processor to exit only if the state was entered with interrupts enabled.")]),t._v(" "),n("p",[t._v("If a store to the address range causes the processor to exit, execution will resume at the instruction following the MWAIT instruction. If an interrupt (including NMI) caused the processor to exit the implementation-dependent-optimized state, the processor will exit the state and handle the interrupt. If an SMI caused the processor to exit the implementation-dependent-optimized state, execution will resume at the instruction following MWAIT after handling of the SMI.")]),t._v(" "),n("p",[t._v("Unlike the HLT instruction, the MWAIT instruction does not support a restart at the MWAIT instruction. There may also be other implementation-dependent events or time-outs that may take the processor out of the implementation-dependent-optimized state and resume execution at the instruction following the MWAIT.")]),t._v(" "),n("p",[t._v("If the preceding MONITOR instruction did not successfully arm an address range or if the MONITOR instruction has not been executed prior to executing MWAIT, then the processor will not enter the implementation-dependent-optimized state. Execution will resume at the instruction following the MWAIT.")]),t._v(" "),n("p",[t._v("The MWAIT instruction can be executed at any privilege level. The MONITOR CPUID feature flag (ECX[bit 3] when CPUID is executed with EAX = 1) indicates the availability of the MONITOR and MWAIT instruction in a processor. When set, the unconditional execution of MWAIT is supported at privilege level 0 and conditional execution is supported at privilege levels 1 through 3 (software should test for the appropriate support of these instructions before unconditional use).")]),t._v(" "),n("p",[t._v("The operating system or system BIOS may disable this instruction using the IA32_MISC_ENABLES MSR; disabling the instruction clears the CPUID feature flag and causes execution of the MWAIT instruction to generate an illegal opcode exception.")]),t._v(" "),n("h2",{attrs:{id:"operation"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#operation"}},[t._v("#")]),t._v(" Operation")]),t._v(" "),n("div",{staticClass:"language-c line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-c"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nMWAIT takes the argument in EAX as a hint extension and is\narchitected to take the argument in ECX as an instruction extension\nMWAIT EAX, ECX\n*/")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("while")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("GetMonitorState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!=")]),t._v(" StateArmed"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("OptimizedState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ECX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Monitor Hardware is not in armed state yet => implementation dependent optimized state")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("SetMonitorState")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("MonitorTriggered"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//Set the state of Monitor Hardware as Triggered")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("MONITOR")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ECX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" EDX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("if")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("!")]),t._v("TriggerStoreHappened"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token function"}},[t._v("MWAIT")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("EAX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" ECX"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("/*\nThe above code sequence makes sure that a triggering store does not happen between the first\ncheck of the trigger and the execution of the monitor instruction. Without the second check that\ntriggering store would go un-noticed. Typical usage of MONITOR and MWAIT would have the\nabove code sequence within a loop.\n*/")]),t._v("\n\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br")])]),n("h2",{attrs:{id:"exceptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#exceptions"}},[t._v("#")]),t._v(" Exceptions")]),t._v(" "),n("p",[t._v("None.")]),t._v(" "),n("h2",{attrs:{id:"numeric-exceptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#numeric-exceptions"}},[t._v("#")]),t._v(" Numeric Exceptions")]),t._v(" "),n("p",[t._v("None.")]),t._v(" "),n("h2",{attrs:{id:"protected-mode-exceptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#protected-mode-exceptions"}},[t._v("#")]),t._v(" Protected Mode Exceptions")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("a",{attrs:{href:""}})]),t._v(" "),n("th")])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])]),t._v(" "),n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])])])]),t._v(" "),n("h2",{attrs:{id:"real-address-mode-exceptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#real-address-mode-exceptions"}},[t._v("#")]),t._v(" Real-Address Mode Exceptions")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("a",{attrs:{href:""}})]),t._v(" "),n("th")])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])]),t._v(" "),n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])])])]),t._v(" "),n("h2",{attrs:{id:"virtual-8086-mode-exceptions"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#virtual-8086-mode-exceptions"}},[t._v("#")]),t._v(" Virtual-8086 Mode Exceptions")]),t._v(" "),n("table",[n("thead",[n("tr",[n("th",[n("a",{attrs:{href:""}})]),t._v(" "),n("th")])]),t._v(" "),n("tbody",[n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])]),t._v(" "),n("tr",[n("td",[t._v("#GP(0)")]),t._v(" "),n("td",[t._v("For ECX has a value other than 0.")])])])])])}),[],!1,null,null,null);e.default=s.exports}}]);